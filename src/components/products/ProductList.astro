---
// src/components/ProductList.astro
interface Props {
  initialProducts: any[];
  initialCategory?: string; // 'all', 'pulsa', 'kuota'
  initialQuery?: string;
}

const { initialProducts = [], initialCategory = 'all', initialQuery = '' } = Astro.props;
---

<div id="product-list-container" data-products={JSON.stringify(initialProducts)} data-category={initialCategory} data-query={initialQuery}>
    
    <div class="flex flex-col md:flex-row justify-between items-center gap-4 mb-6">
        
        <div class="relative w-full md:w-1/2">
            <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                <i class="fa-solid fa-magnifying-glass text-gray-400"></i>
            </div>
            <input 
                type="text" 
                id="local-search" 
                class="block w-full p-3 pl-10 text-sm text-gray-900 border border-gray-200 rounded-xl bg-white dark:bg-gray-800 dark:border-gray-700 dark:placeholder-gray-400 dark:text-white focus:ring-blue-500 focus:border-blue-500 shadow-sm" 
                placeholder="Cari produk di sini..."
                value={initialQuery} 
            >
        </div>

        <div class="flex items-center gap-2 w-full md:w-auto">
            <span class="text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap"><i class="fa-solid fa-arrow-up-wide-short"></i> Urutkan:</span>
            <select id="sort-select" class="select select-bordered select-sm w-full md:w-auto bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700">
                <option value="default">Paling Sesuai</option>
                <option value="price-asc">Harga Terendah</option>
                <option value="price-desc">Harga Tertinggi</option>
                <option value="name-asc">Nama (A-Z)</option>
            </select>
        </div>
    </div>

    <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
        </div>

    <div id="empty-state" class="hidden py-12 text-center">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 mb-4">
            <i class="fa-solid fa-box-open text-2xl text-gray-400"></i>
        </div>
        <h3 class="text-lg font-bold text-gray-700 dark:text-gray-300">Produk Tidak Ditemukan</h3>
        <p class="text-sm text-gray-500">Coba kata kunci lain atau atur ulang filter.</p>
    </div>

    <div class="mt-8 text-center">
        <button id="btn-load-more" class="hidden btn btn-outline btn-primary rounded-full px-8 normal-case">
            Muat Lebih Banyak <i class="fa-solid fa-chevron-down ml-1"></i>
        </button>
        <p id="end-of-list" class="hidden text-xs text-gray-400 mt-4">- Semua produk telah ditampilkan -</p>
    </div>

</div>

<script>
    import { initProductList } from '../../scripts/products/list.js';

    document.addEventListener('astro:page-load', () => {
        initProductList();
    });
</script>